"use strict";function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var PackerGenerator=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{inlineStyles:!0},e={column:t.inlineStyles?{flex:1}:{},container:t.inlineStyles?{display:"flex","align-items":"flex-start","justify-content":"center","flex-wrap":"wrap"}:{}};return{mounted:function(){this.build(),window.addEventListener("resize",this.onResize)},destroyed:function(){window.removeEventListener("resize",this.onResize)},props:{baseClass:{type:String,default:"packer"},sizerClass:{type:String,default:"sizer"},columnClass:{type:String,default:"col"},tag:{type:String,default:"div"}},data:function(){return{building:!1,calculating:!1,columnCount:0,columns:[],initialized:!1,items:[],queue:[]}},computed:{content:function(){return this.$slots.default},sizerStyle:function(){return this.calculating?{display:"block",visibility:"hidden !important",top:"-1000px !important"}:{display:"none"}}},methods:{onResize:function(){this.build()},build:function(){var t=this;if(this.building)return!1;this.building=!0;var e=this.columnCount;return this.setColumnCount().then(function(){t.columnCount!==e&&t.rebuild(),t.building=!1})},rebuild:function(){this.reset();var t=this.content;this.appendItems(t)},setColumnCount:function(){var t=this;return this.calculating=!0,this.$nextTick().then(function(){var e=t.getContainerWidth(),n=t.getSizerWidth();t.columnCount=0===n?1:Math.round(e/n),t.calculating=!1})},appendItems:function(t){this.queue=[].concat(_toConsumableArray(t)),this.$nextTick(this.processQueue)},processQueue:function(){var t=this,e=this.getShortestColumnIndex(),n=this.queue.shift();this.items.push(n),this.columns[e].push(n),this.$nextTick(function(){t.queue.length?t.processQueue():t.initialized=!0})},reset:function(){this.items=[],this.columns=Array.from({length:this.columnCount},function(){return[]})},getShortestColumnIndex:function(){var t=this,e=this.columnCount,n=this.items;if(e<=1)return 0;if(n.length<e)return n.length;var i=this.columns.map(function(e,n){return t.$refs["col-"+n].offsetHeight}),s=Math.min.apply(null,i);return i.indexOf(s)},getSizerWidth:function(){return this.$refs.sizer.offsetWidth},getContainerWidth:function(){return this.$refs.packer.offsetWidth}},render:function(t){var n=this,i=t("div",{class:this.baseClass+"-"+this.sizerClass,style:this.sizerStyle,ref:"sizer"}),s=this.columns.map(function(i,s){return t("div",{class:n.baseClass+"-"+n.columnClass,style:e.column,ref:"col-"+s,key:s+"-"+i.count},i)});return t(this.tag,{class:this.baseClass,style:e.container,ref:"packer"},[i].concat(_toConsumableArray(s)))}}},index={install:function(t,e){var n=PackerGenerator(e);t.component("vue-packer",n)}};module.exports=index;
